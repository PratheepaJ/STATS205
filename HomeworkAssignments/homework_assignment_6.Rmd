---
title: "STATS 205: Homework Assignment 6 (Spring 2019)"
author: ""
date: "5/20/2019"
output:
  pdf_document: 
    includes:
      in_header: header.tex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

Solve problems 1-2 and 4 from the textbook **HWC** [available here](https://onlinelibrary.wiley.com/doi/book/10.1002/9781119196037) and problem 3 from **W 2006**.

Send your Rmd and PDF files to pjeganat [at] stanford [dot] edu.

**Due on 5/28/2019 (Tuesday) at 1.30 p.m.**

1) **HWC** Page 661, Problem 1 (local averaging).
The data set `cars` from Ezekiel (1930) contains stopping distances for various speeds. Smooth the data using Friedman’s smoother by choosing your own value of the span. Use dist as the dependent (response) variable and speed as the independent (predictor) variable. Using trial and error, what seems to be a reasonable span? Comment on the graphical comparison between the estimate using your choice of span with the estimate using the span chosen by cross-validation.
```{r}
library(datasets)
data(cars)
head(cars)
```


2) **HWC** Page 661, Problem 2 (local averaging and choosing optimal span).

Consider the data set sunspots from Andrews and Herzberg (1985) as a response variable. For the predictor data $x$, use
```{r}
data("sunspots")
x = c(1:length(sunspots))
```

Apply Friedman’s smoother using trial and error to find a span that seems to work well with the data. Then find an estimate using the span determined by cross-validation. Describe the results (taking into account Comment 5).
```{r}
y = sunspots
```


3) **W 2006** Page 121, Problem 3.

Download and save `forensic_glass_data_W2006.dat` available at [Canvas @ Stanford](https://canvas.stanford.edu/courses/99104/files/folder/Data) 

```{r}
forensic.data = read.table("forensic_glass_data_W2006.dat", header = TRUE)
head(forensic.data)
```

Let $Y$ be refractive index and let $x$ be aluminium content (the fourth variable). 
```{r}
library(dplyr)
Y = select(forensic.data, RI)
x = select(forensic.data, Al)
```

    (1) Perform a nonparametric regression to fit the model $Y = r\left(x\right)+\epsilon$. Use the following estimators: 
    
        (i) regressogram, 
    
        (ii) kernel,
    
        (iii) local linear kernel regression, 
    
        (iv) spline. 

    In each case, use cross-validation to choose the amount of smoothing. 

    (2) Estimate the variance. 

    (3) Construct 95 percent confidence bands for your estimates.


4) **HWC** Page 644 Problem 6 (a)  (Wavelet). 
Let $y$ be the first 512 components in the sunspots data from package datasets. 

(a) Use the `mra` command to plot $f_{4}$, $f_{5}$ and $f_{6}$ using the Haar wavelet. Describe the different characteristics of each of these three smooth approximations. For example, use $J =5$ and either $[[6]]$ or \$S5  to find $f_{4}$.

